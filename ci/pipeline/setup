#!/bin/bash

bash ./ci/tools/install_android
bash ./ci/tools/install_java_11
export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64

git submodule init
git submodule update

echo "org.gradle.caching=true" >>gradle.properties

#########################################################################################
# We turn of the daemon because gradle recommends it when using containerized CI.
# The daemon is used to speed up subsequant builds, and since we don't run builds twice
# on the same machine, the daemon is an un-needed long life background process.
#########################################################################################
echo "org.gradle.daemon=false" >>gradle.properties

#########################################################################################
# https://confluence.atlassian.com/bitbucket/configure-bitbucket-pipelines-yml-792298910.html
#########################################################################################
echo "org.gradle.jvmargs=-Xmx6g"

touch /opt/atlassian/pipelines/agent/build/local.properties
